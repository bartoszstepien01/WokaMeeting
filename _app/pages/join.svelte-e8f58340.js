import{b as A,_ as J}from"../chunks/paths-16c013c9.js";import{S as K,i as H,s as O,j as V,m as j,o as D,x as b,u as k,v as I,e as L,t as z,k as R,L as B,c as q,a as U,g as F,d as _,n as C,b as E,H as S,f as N,w as Q,A as W,r as X}from"../chunks/vendor-7aa203f2.js";import{N as Y,C as Z,M as x,G as ee,S as se}from"../chunks/Members-f99e7f5c.js";function y(t){let i,a;return i=new ee({props:{streams:t[3],sidePanelVisible:t[1]||t[2]}}),{c(){V(i.$$.fragment)},l(s){j(i.$$.fragment,s)},m(s,c){D(i,s,c),a=!0},p(s,c){const f={};c&8&&(f.streams=s[3]),c&6&&(f.sidePanelVisible=s[1]||s[2]),i.$set(f)},i(s){a||(b(i.$$.fragment,s),a=!0)},o(s){k(i.$$.fragment,s),a=!1},d(s){I(i,s)}}}function ae(t){let i,a,s,c,f,r,o,w,p,P,h,M,d,$;o=new Y({props:{time:t[4],peer:!0}}),o.$on("videoswitch",t[6]),o.$on("muteswitch",t[7]),o.$on("sourceswitch",t[8]),o.$on("chatswitch",t[9]),o.$on("membersswitch",t[10]);let n=t[3].length!==0&&y(t);return h=new Z({props:{visible:t[1],messages:t[5]}}),h.$on("close",t[11]),h.$on("messagesend",t[12]),d=new x({props:{visible:t[2],users:t[3]}}),d.$on("close",t[13]),{c(){i=L("link"),a=L("link"),s=L("script"),c=z("let parcelRequire;"),f=R(),r=L("div"),V(o.$$.fragment),w=R(),n&&n.c(),P=R(),V(h.$$.fragment),M=R(),V(d.$$.fragment),this.h()},l(e){const l=B('[data-svelte="svelte-uncxtc"]',document.head);i=q(l,"LINK",{rel:!0,href:!0}),a=q(l,"LINK",{rel:!0,href:!0}),s=q(l,"SCRIPT",{});var m=U(s);c=F(m,"let parcelRequire;"),m.forEach(_),l.forEach(_),f=C(e),r=q(e,"DIV",{class:!0});var u=U(r);j(o.$$.fragment,u),w=C(u),n&&n.l(u),u.forEach(_),P=C(e),j(h.$$.fragment,e),M=C(e),j(d.$$.fragment,e),this.h()},h(){E(i,"rel","icon"),E(i,"href",""+(A+"/favicon.png")),E(a,"rel","manifest"),E(a,"href",""+(A+"/manifest.json")),document.title="Join",E(r,"class",p=""+((t[1]||t[2]?"hidden":"flex")+" md:flex flex-col h-screen w-full items-center"))},m(e,l){S(document.head,i),S(document.head,a),S(document.head,s),S(s,c),N(e,f,l),N(e,r,l),D(o,r,null),S(r,w),n&&n.m(r,null),N(e,P,l),D(h,e,l),N(e,M,l),D(d,e,l),$=!0},p(e,[l]){const m={};l&16&&(m.time=e[4]),o.$set(m),e[3].length!==0?n?(n.p(e,l),l&8&&b(n,1)):(n=y(e),n.c(),b(n,1),n.m(r,null)):n&&(X(),k(n,1,1,()=>{n=null}),Q()),(!$||l&6&&p!==(p=""+((e[1]||e[2]?"hidden":"flex")+" md:flex flex-col h-screen w-full items-center")))&&E(r,"class",p);const u={};l&2&&(u.visible=e[1]),l&32&&(u.messages=e[5]),h.$set(u);const v={};l&4&&(v.visible=e[2]),l&8&&(v.users=e[3]),d.$set(v)},i(e){$||(b(o.$$.fragment,e),b(n),b(h.$$.fragment,e),b(d.$$.fragment,e),$=!0)},o(e){k(o.$$.fragment,e),k(n),k(h.$$.fragment,e),k(d.$$.fragment,e),$=!1},d(e){_(i),_(a),_(s),e&&_(f),e&&_(r),I(o),n&&n.d(),e&&_(P),I(h,e),e&&_(M),I(d,e)}}}function te(t,i,a){let s,c=!1,f=!1,r=[],o=0,w=[],p="";return W(async()=>{const u=(await J(()=>import("../chunks/Peer-01a8ed0e.js"),["chunks/Peer-01a8ed0e.js","chunks/index-d95014bb.js","chunks/vendor-7aa203f2.js","assets/vendor-b8c56e4e.css"])).default;p=window.prompt("Enter username: ");let v=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),G=new URL(window.location.href);a(0,s=new u(p,v,G.searchParams.get("room"))),s.on("peer",g=>{r.map(T=>T.stream.id).includes(g.stream.id)||a(3,r=[...r,g])}),s.on("open",g=>{a(3,r=[{id:g,username:p,stream:v}]),setInterval(()=>a(4,o++,o),1e3)}),s.on("disconnect",g=>{a(3,r=r.filter(T=>T.id!=g))}),s.on("message",g=>{a(5,w=[...w,g])})}),[s,c,f,r,o,w,()=>r[0].stream.getVideoTracks().forEach(m=>m.enabled=!m.enabled),()=>r[0].stream.getAudioTracks().forEach(m=>m.enabled=!m.enabled),async m=>{let u=m.detail.source==se.Screen?await navigator.mediaDevices.getDisplayMedia({video:!0}):await navigator.mediaDevices.getUserMedia({video:!0});s.replaceStream(u)},()=>{a(1,c=!c),a(2,f=!1)},()=>{a(2,f=!f),a(1,c=!1)},()=>a(1,c=!1),m=>s.send(m.detail.message),()=>a(2,f=!1)]}class ie extends K{constructor(i){super();H(this,i,te,ae,O,{})}}export{ie as default};
