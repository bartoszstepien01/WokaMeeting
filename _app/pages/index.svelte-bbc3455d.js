import{b as O,_ as Q}from"../chunks/paths-16c013c9.js";import{S as U,i as A,s as L,J as W,K as X,D as Y,e as k,t as j,k as V,j as N,c as E,a as I,g as M,d as b,n as y,m as q,b as $,f as x,H as w,o as C,L as Z,h as ee,E as te,F as se,G as le,x as P,u as S,v as G,M as ae,N as re,I as ne,O as H,P as ie,Q as oe,w as ce,A as fe,r as ue}from"../chunks/vendor-f5d27702.js";import{N as de,G as he,S as me}from"../chunks/Navbar-fe9f1e27.js";function _e(n){let e,l,t,o,h,i,r,p,d,u,g,_;r=new W({props:{icon:X,color:"#ffffff",scale:1.3}});const c=n[4].default,s=Y(c,n,n[3],null);return{c(){e=k("div"),l=k("div"),t=k("h1"),o=j(n[0]),h=V(),i=k("button"),N(r.$$.fragment),p=V(),s&&s.c(),this.h()},l(a){e=E(a,"DIV",{class:!0});var m=I(e);l=E(m,"DIV",{class:!0});var f=I(l);t=E(f,"H1",{class:!0});var T=I(t);o=M(T,n[0]),T.forEach(b),h=y(f),i=E(f,"BUTTON",{class:!0});var v=I(i);q(r.$$.fragment,v),v.forEach(b),f.forEach(b),p=y(m),s&&s.l(m),m.forEach(b),this.h()},h(){$(t,"class","text-3xl text-white font-semibold"),$(i,"class","block md:hidden ml-auto"),$(l,"class","flex mb-3"),$(e,"class",d=""+((n[1]?"flex":"hidden")+" flex-col w-full h-screen bg-gray-800 border-l-2 border-gray-700 px-4 pt-3 pb-8"))},m(a,m){x(a,e,m),w(e,l),w(l,t),w(t,o),w(l,h),w(l,i),C(r,i,null),w(e,p),s&&s.m(e,null),u=!0,g||(_=Z(i,"click",n[5]),g=!0)},p(a,[m]){(!u||m&1)&&ee(o,a[0]),s&&s.p&&(!u||m&8)&&te(s,c,a,a[3],u?le(c,a[3],m,null):se(a[3]),null),(!u||m&2&&d!==(d=""+((a[1]?"flex":"hidden")+" flex-col w-full h-screen bg-gray-800 border-l-2 border-gray-700 px-4 pt-3 pb-8")))&&$(e,"class",d)},i(a){u||(P(r.$$.fragment,a),P(s,a),u=!0)},o(a){S(r.$$.fragment,a),S(s,a),u=!1},d(a){a&&b(e),G(r),s&&s.d(a),g=!1,_()}}}function pe(n,e,l){let{$$slots:t={},$$scope:o}=e,{title:h}=e,{visible:i}=e;const r=ae(),p=()=>r("close");return n.$$set=d=>{"title"in d&&l(0,h=d.title),"visible"in d&&l(1,i=d.visible),"$$scope"in d&&l(3,o=d.$$scope)},[h,i,r,o,t,p]}class ve extends U{constructor(e){super();A(this,e,pe,_e,L,{title:0,visible:1})}}function K(n,e,l){const t=n.slice();return t[1]=e[l],t}function B(n,e,l){const t=n.slice();return t[6]=e[l],t}function F(n){let e,l,t=n[6].message+"",o,h,i;return{c(){e=k("div"),l=k("p"),o=j(t),h=V(),this.h()},l(r){e=E(r,"DIV",{class:!0});var p=I(e);l=E(p,"P",{});var d=I(l);o=M(d,t),d.forEach(b),h=y(p),p.forEach(b),this.h()},h(){$(e,"class",i="flex items-center bg-gray-600 text-white rounded-b-md "+(n[1][0].me?"rounded-tl-md":"rounded-tr-md")+" flex-1 px-2 py-2")},m(r,p){x(r,e,p),w(e,l),w(l,o),w(e,h)},p:ne,d(r){r&&b(e)}}}function z(n){let e,l,t,o,h,i,r,p=n[1][0].author+"",d,u,g,_,c=n[1],s=[];for(let a=0;a<c.length;a+=1)s[a]=F(B(n,c,a));return{c(){e=k("div"),l=k("img"),h=V(),i=k("div"),r=k("p"),d=j(p),u=V();for(let a=0;a<s.length;a+=1)s[a].c();g=V(),this.h()},l(a){e=E(a,"DIV",{class:!0});var m=I(e);l=E(m,"IMG",{src:!0,alt:!0,class:!0}),h=y(m),i=E(m,"DIV",{class:!0});var f=I(i);r=E(f,"P",{class:!0});var T=I(r);d=M(T,p),T.forEach(b),u=y(f);for(let v=0;v<s.length;v+=1)s[v].l(f);f.forEach(b),g=y(m),m.forEach(b),this.h()},h(){re(l.src,t="https://avatars.dicebear.com/api/initials/"+n[1][0].author+".svg")||$(l,"src",t),$(l,"alt",o=n[1][0].author),$(l,"class","rounded-md w-12 h-12 mt-auto"),$(r,"class","text-gray-400 text-xs"),$(i,"class","flex flex-col flex-1 gap-1"),$(e,"class",_="flex gap-2 "+(n[1][0].me?"flex-row-reverse":"flex-row"))},m(a,m){x(a,e,m),w(e,l),w(e,h),w(e,i),w(i,r),w(r,d),w(i,u);for(let f=0;f<s.length;f+=1)s[f].m(i,null);w(e,g)},p(a,m){if(m&4){c=a[1];let f;for(f=0;f<c.length;f+=1){const T=B(a,c,f);s[f]?s[f].p(T,m):(s[f]=F(T),s[f].c(),s[f].m(i,null))}for(;f<s.length;f+=1)s[f].d(1);s.length=c.length}},d(a){a&&b(e),H(s,a)}}}function ge(n){let e,l,t,o,h,i,r,p=n[2],d=[];for(let u=0;u<p.length;u+=1)d[u]=z(K(n,p,u));return{c(){e=k("div");for(let u=0;u<d.length;u+=1)d[u].c();l=V(),t=k("div"),o=k("input"),h=V(),i=k("button"),r=j("Send"),this.h()},l(u){e=E(u,"DIV",{class:!0});var g=I(e);for(let s=0;s<d.length;s+=1)d[s].l(g);g.forEach(b),l=y(u),t=E(u,"DIV",{class:!0});var _=I(t);o=E(_,"INPUT",{type:!0,class:!0,placeholder:!0}),h=y(_),i=E(_,"BUTTON",{class:!0});var c=I(i);r=M(c,"Send"),c.forEach(b),_.forEach(b),this.h()},h(){$(e,"class","flex flex-col h-auto flex-1 gap-6"),$(o,"type","text"),$(o,"class","w-full bg-gray-700 text-white focus:outline-none h-9 px-4 rounded-md"),$(o,"placeholder","Aa"),$(i,"class","text-white bg-blue-600 px-4 rounded-md"),$(t,"class","flex gap-2")},m(u,g){x(u,e,g);for(let _=0;_<d.length;_+=1)d[_].m(e,null);x(u,l,g),x(u,t,g),w(t,o),w(t,h),w(t,i),w(i,r)},p(u,g){if(g&4){p=u[2];let _;for(_=0;_<p.length;_+=1){const c=K(u,p,_);d[_]?d[_].p(c,g):(d[_]=z(c),d[_].c(),d[_].m(e,null))}for(;_<d.length;_+=1)d[_].d(1);d.length=p.length}},d(u){u&&b(e),H(d,u),u&&b(l),u&&b(t)}}}function be(n){let e,l;return e=new ve({props:{title:"Chat",visible:n[0],$$slots:{default:[ge]},$$scope:{ctx:n}}}),e.$on("close",n[3]),{c(){N(e.$$.fragment)},l(t){q(e.$$.fragment,t)},m(t,o){C(e,t,o),l=!0},p(t,[o]){const h={};o&1&&(h.visible=t[0]),o&512&&(h.$$scope={dirty:o,ctx:t}),e.$set(h)},i(t){l||(P(e.$$.fragment,t),l=!0)},o(t){S(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function we(n,e,l){let{visible:t=!1}=e,{messages:o=[]}=e,h=[];function i(r){ie.call(this,n,r)}return n.$$set=r=>{"visible"in r&&l(0,t=r.visible),"messages"in r&&l(1,o=r.messages)},n.$$.update=()=>{if(n.$$.dirty&2){let r=[];o.forEach(p=>{if(r.length==0||r[r.length-1]!=p.id){r.push(p.id),h.push([p]);return}h[h.length-1].push(p)})}},[t,o,h,i]}class $e extends U{constructor(e){super();A(this,e,we,be,L,{visible:0,messages:1})}}function J(n){let e,l;return e=new he({props:{streams:n[0],sidePanelVisible:n[3]}}),{c(){N(e.$$.fragment)},l(t){q(e.$$.fragment,t)},m(t,o){C(e,t,o),l=!0},p(t,o){const h={};o&1&&(h.streams=t[0]),o&8&&(h.sidePanelVisible=t[3]),e.$set(h)},i(t){l||(P(e.$$.fragment,t),l=!0)},o(t){S(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function ke(n){let e,l,t,o,h,i,r,p,d,u,g,_;r=new de({props:{time:n[1]}}),r.$on("videoswitch",n[4]),r.$on("muteswitch",n[5]),r.$on("sourceswitch",n[6]),r.$on("chatswitch",n[7]);let c=n[0].length!==0&&J(n);return g=new $e({props:{visible:n[3],messages:[]}}),g.$on("close",n[8]),{c(){e=k("link"),l=k("link"),t=k("script"),o=j("let parcelRequire;"),h=V(),i=k("div"),N(r.$$.fragment),p=V(),c&&c.c(),u=V(),N(g.$$.fragment),this.h()},l(s){const a=oe('[data-svelte="svelte-tu3wcf"]',document.head);e=E(a,"LINK",{rel:!0,href:!0}),l=E(a,"LINK",{rel:!0,href:!0}),t=E(a,"SCRIPT",{});var m=I(t);o=M(m,"let parcelRequire;"),m.forEach(b),a.forEach(b),h=y(s),i=E(s,"DIV",{class:!0});var f=I(i);q(r.$$.fragment,f),p=y(f),c&&c.l(f),f.forEach(b),u=y(s),q(g.$$.fragment,s),this.h()},h(){$(e,"rel","icon"),$(e,"href",""+(O+"/favicon.png")),$(l,"rel","manifest"),$(l,"href",""+(O+"/manifest.json")),document.title="Home",$(i,"class",d=""+((n[3]?"hidden":"flex")+" md:flex flex-col h-screen w-screen items-center"))},m(s,a){w(document.head,e),w(document.head,l),w(document.head,t),w(t,o),x(s,h,a),x(s,i,a),C(r,i,null),w(i,p),c&&c.m(i,null),x(s,u,a),C(g,s,a),_=!0},p(s,[a]){const m={};a&2&&(m.time=s[1]),r.$set(m),s[0].length!==0?c?(c.p(s,a),a&1&&P(c,1)):(c=J(s),c.c(),P(c,1),c.m(i,null)):c&&(ue(),S(c,1,1,()=>{c=null}),ce()),(!_||a&8&&d!==(d=""+((s[3]?"hidden":"flex")+" md:flex flex-col h-screen w-screen items-center")))&&$(i,"class",d);const f={};a&8&&(f.visible=s[3]),g.$set(f)},i(s){_||(P(r.$$.fragment,s),P(c),P(g.$$.fragment,s),_=!0)},o(s){S(r.$$.fragment,s),S(c),S(g.$$.fragment,s),_=!1},d(s){b(e),b(l),b(t),s&&b(h),s&&b(i),G(r),c&&c.d(),s&&b(u),G(g,s)}}}function Ee(n,e,l){let t=[],o=[],h=0,i=[],r=!1;return fe(async()=>{const s=(await Q(()=>import("../chunks/peerjs.min-660c7b4c.js").then(function(v){return v.p}),["chunks/peerjs.min-660c7b4c.js","chunks/vendor-f5d27702.js","assets/vendor-b8c56e4e.css"])).default;let a="DeathGuard12",m=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});l(0,t=[{username:a,stream:m}]);let f=[],T=new s(void 0,{config:{iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:numb.viagenie.ca",credential:"muazkh",username:"webrtc@live.com"}]}});T.on("open",v=>{console.log(v),o=[v],setInterval(()=>l(1,h++,h),1e3)}),T.on("call",v=>{o=[...o,v.peer],l(2,i=[...i,v]),v.answer(m),v.on("stream",D=>{t.map(R=>R.stream.id).includes(D.id)||l(0,t=[...t,{username:v.metadata.username,stream:D}])})}),T.on("connection",v=>{v.on("open",()=>{f.forEach(D=>{D.send({type:"connect",data:{peerId:v.peer,username:v.metadata.username}})}),v.send({type:"username",data:{username:a}}),f.push(v)}),v.on("close",()=>{f=f.filter(D=>D!=v),l(0,t=t.filter((D,R)=>o[R]!=v.peer)),o=o.filter(D=>D!=v.peer),l(2,i=i.filter(D=>D.peer!=v.peer)),f.forEach(D=>{D.send({type:"disconnect",data:{peerId:v.peer}})})}),window.onunload=window.onbeforeunload=()=>{v.close()}})}),[t,h,i,r,()=>t[0].stream.getVideoTracks().forEach(c=>c.enabled=!c.enabled),()=>t[0].stream.getAudioTracks().forEach(c=>c.enabled=!c.enabled),async c=>{let a=(c.detail.source==me.Screen?await navigator.mediaDevices.getDisplayMedia({video:!0}):await navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0];t[0].stream.getVideoTracks().forEach(m=>{m.stop(),t[0].stream.removeTrack(m)}),t[0].stream.addTrack(a),i.forEach(m=>m.peerConnection.getSenders().filter(f=>f.track.kind=="video").forEach(f=>f.replaceTrack(a)))},()=>l(3,r=!r),()=>l(3,r=!1)]}class Ve extends U{constructor(e){super();A(this,e,Ee,ke,L,{})}}export{Ve as default};
