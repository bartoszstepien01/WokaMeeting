import{b as T,_ as G}from"../chunks/paths-16c013c9.js";import{S as J,i as K,s as H,j as S,m as V,o as j,x as w,u as $,v as D,e as I,t as O,k as L,L as z,c as R,a as y,g as B,d as _,n as q,b as v,H as M,f as C,w as F,A as Q,r as W}from"../chunks/vendor-ef7a3a0d.js";import{N as X,C as Y,M as Z,G as x,S as ee}from"../chunks/Members-dd352666.js";function A(r){let i,t;return i=new x({props:{streams:r[3],sidePanelVisible:r[1]||r[2]}}),{c(){S(i.$$.fragment)},l(a){V(i.$$.fragment,a)},m(a,m){j(i,a,m),t=!0},p(a,m){const c={};m&8&&(c.streams=a[3]),m&6&&(c.sidePanelVisible=a[1]||a[2]),i.$set(c)},i(a){t||(w(i.$$.fragment,a),t=!0)},o(a){$(i.$$.fragment,a),t=!1},d(a){D(i,a)}}}function se(r){let i,t,a,m,c,n,o,g,k,E,f,P,h,b;o=new X({props:{time:ae,peer:!0}}),o.$on("videoswitch",r[5]),o.$on("muteswitch",r[6]),o.$on("sourceswitch",r[7]),o.$on("chatswitch",r[8]),o.$on("membersswitch",r[9]);let l=r[3].length!==0&&A(r);return f=new Y({props:{visible:r[1],messages:r[4]}}),f.$on("close",r[10]),f.$on("messagesend",r[11]),h=new Z({props:{visible:r[2],users:r[3]}}),h.$on("close",r[12]),{c(){i=I("link"),t=I("link"),a=I("script"),m=O("let parcelRequire;"),c=L(),n=I("div"),S(o.$$.fragment),g=L(),l&&l.c(),E=L(),S(f.$$.fragment),P=L(),S(h.$$.fragment),this.h()},l(e){const s=z('[data-svelte="svelte-uncxtc"]',document.head);i=R(s,"LINK",{rel:!0,href:!0}),t=R(s,"LINK",{rel:!0,href:!0}),a=R(s,"SCRIPT",{});var d=y(a);m=B(d,"let parcelRequire;"),d.forEach(_),s.forEach(_),c=q(e),n=R(e,"DIV",{class:!0});var u=y(n);V(o.$$.fragment,u),g=q(u),l&&l.l(u),u.forEach(_),E=q(e),V(f.$$.fragment,e),P=q(e),V(h.$$.fragment,e),this.h()},h(){v(i,"rel","icon"),v(i,"href",""+(T+"/favicon.png")),v(t,"rel","manifest"),v(t,"href",""+(T+"/manifest.json")),document.title="Join",v(n,"class",k=""+((r[1]||r[2]?"hidden":"flex")+" md:flex flex-col h-screen w-full items-center"))},m(e,s){M(document.head,i),M(document.head,t),M(document.head,a),M(a,m),C(e,c,s),C(e,n,s),j(o,n,null),M(n,g),l&&l.m(n,null),C(e,E,s),j(f,e,s),C(e,P,s),j(h,e,s),b=!0},p(e,[s]){e[3].length!==0?l?(l.p(e,s),s&8&&w(l,1)):(l=A(e),l.c(),w(l,1),l.m(n,null)):l&&(W(),$(l,1,1,()=>{l=null}),F()),(!b||s&6&&k!==(k=""+((e[1]||e[2]?"hidden":"flex")+" md:flex flex-col h-screen w-full items-center")))&&v(n,"class",k);const d={};s&2&&(d.visible=e[1]),s&16&&(d.messages=e[4]),f.$set(d);const u={};s&4&&(u.visible=e[2]),s&8&&(u.users=e[3]),h.$set(u)},i(e){b||(w(o.$$.fragment,e),w(l),w(f.$$.fragment,e),w(h.$$.fragment,e),b=!0)},o(e){$(o.$$.fragment,e),$(l),$(f.$$.fragment,e),$(h.$$.fragment,e),b=!1},d(e){_(i),_(t),_(a),e&&_(c),e&&_(n),D(o),l&&l.d(),e&&_(E),D(f,e),e&&_(P),D(h,e)}}}let ae=0;function te(r,i,t){let a,m=!1,c=!1,n=[],o=[],g="";return Q(async()=>{const d=(await G(()=>import("../chunks/Peer-343ed430.js"),["chunks/Peer-343ed430.js","chunks/index-f1a506a4.js","chunks/vendor-ef7a3a0d.js","assets/vendor-b8c56e4e.css"])).default;g=window.prompt("Enter username: ");let u=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),U=new URL(window.location.href);t(0,a=new d(g,u,U.searchParams.get("room"))),a.on("peer",p=>{n.map(N=>N.stream.id).includes(p.stream.id)||t(3,n=[...n,p])}),a.on("open",p=>{t(3,n=[{id:p,username:g,stream:u}])}),a.on("disconnect",p=>{t(3,n=n.filter(N=>N.id!=p))}),a.on("message",p=>{t(4,o=[...o,p])})}),[a,m,c,n,o,()=>n[0].stream.getVideoTracks().forEach(s=>s.enabled=!s.enabled),()=>n[0].stream.getAudioTracks().forEach(s=>s.enabled=!s.enabled),async s=>{let d=s.detail.source==ee.Screen?await navigator.mediaDevices.getDisplayMedia({video:!0}):await navigator.mediaDevices.getUserMedia({video:!0});a.replaceStream(d)},()=>{t(1,m=!m),t(2,c=!1)},()=>{t(2,c=!c),t(1,m=!1)},()=>t(1,m=!1),s=>a.send(s.detail.message),()=>t(2,c=!1)]}class ie extends J{constructor(i){super();K(this,i,te,se,H,{})}}export{ie as default};
