import{b as y,_ as P}from"../chunks/paths-16c013c9.js";import{S,i as D,s as G,j as L,m as N,o as x,x as _,u as w,v as A,e as h,t as C,k as j,l as $,J as H,c as v,a as E,g as K,d as i,n as I,b as d,H as g,f as k,w as M,A as T,r as V}from"../chunks/vendor-07f555be.js";import{G as z}from"../chunks/Gallery-7199c69d.js";function R(p){let s,n;return s=new z({props:{streams:p[0]}}),{c(){L(s.$$.fragment)},l(r){N(s.$$.fragment,r)},m(r,o){x(s,r,o),n=!0},p(r,o){const c={};o&1&&(c.streams=r[0]),s.$set(c)},i(r){n||(_(s.$$.fragment,r),n=!0)},o(r){w(s.$$.fragment,r),n=!1},d(r){A(s,r)}}}function J(p){let s,n,r,o,c,u,m,l,f,e=p[0].length!==0&&R(p);return{c(){s=h("link"),n=h("link"),r=h("script"),o=C("let parcelRequire;"),c=j(),u=h("div"),m=j(),e&&e.c(),l=$(),this.h()},l(t){const a=H('[data-svelte="svelte-tu3wcf"]',document.head);s=v(a,"LINK",{rel:!0,href:!0}),n=v(a,"LINK",{rel:!0,href:!0}),r=v(a,"SCRIPT",{});var b=E(r);o=K(b,"let parcelRequire;"),b.forEach(i),a.forEach(i),c=I(t),u=v(t,"DIV",{class:!0});var q=E(u);q.forEach(i),m=I(t),e&&e.l(t),l=$(),this.h()},h(){d(s,"rel","icon"),d(s,"href",""+(y+"/favicon.png")),d(n,"rel","manifest"),d(n,"href",""+(y+"/manifest.json")),document.title="Home",d(u,"class","w-screen bg-gray-700 h-16")},m(t,a){g(document.head,s),g(document.head,n),g(document.head,r),g(r,o),k(t,c,a),k(t,u,a),k(t,m,a),e&&e.m(t,a),k(t,l,a),f=!0},p(t,[a]){t[0].length!==0?e?(e.p(t,a),a&1&&_(e,1)):(e=R(t),e.c(),_(e,1),e.m(l.parentNode,l)):e&&(V(),w(e,1,1,()=>{e=null}),M())},i(t){f||(_(e),f=!0)},o(t){w(e),f=!1},d(t){i(s),i(n),i(r),t&&i(c),t&&i(u),t&&i(m),e&&e.d(t),t&&i(l)}}}function O(p,s,n){let r=[],o=[];return T(async()=>{const u=(await P(()=>import("../chunks/peerjs.min-90eb8cad.js").then(function(e){return e.p}),["chunks/peerjs.min-90eb8cad.js","chunks/vendor-07f555be.js"])).default;let m=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});n(0,r=[m]);let l=[],f=new u(void 0,{config:{iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:numb.viagenie.ca",credential:"muazkh",username:"webrtc@live.com"}]}});f.on("open",e=>{console.log(e),o=[e]}),f.on("call",e=>{o=[...o,e.peer],e.answer(m),e.on("stream",t=>{r.map(a=>a.id).includes(t.id)||n(0,r=[...r,t])})}),f.on("connection",e=>{e.on("open",()=>{l.forEach(t=>{t.send({type:"connect",data:{peerId:e.peer}})}),l.push(e)}),e.on("close",()=>{l=l.filter(t=>t!=e),n(0,r=r.filter((t,a)=>o[a]!=e.peer)),o=o.filter(t=>t!=e.peer),l.forEach(t=>{t.send({type:"disconnect",data:{peerId:e.peer}})})}),window.onunload=window.onbeforeunload=()=>{e.close()}})}),[r]}class Q extends S{constructor(s){super();D(this,s,O,J,G,{})}}export{Q as default};
