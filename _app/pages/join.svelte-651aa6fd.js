import{b as k,_ as j}from"../chunks/paths-16c013c9.js";import{S as w,i as P,s as R,j as q,m as E,o as I,x as p,u as h,v as L,e as g,t as S,k as x,l as b,J as G,c as v,a as J,g as N,d as u,n as A,b as _,H as d,f as y,w as C,A as D,r as K}from"../chunks/vendor-07f555be.js";import{G as M}from"../chunks/Gallery-4bcb3b09.js";function $(m){let a,n;return a=new M({props:{streams:m[0]}}),{c(){q(a.$$.fragment)},l(e){E(a.$$.fragment,e)},m(e,i){I(a,e,i),n=!0},p(e,i){const l={};i&1&&(l.streams=e[0]),a.$set(l)},i(e){n||(p(a.$$.fragment,e),n=!0)},o(e){h(a.$$.fragment,e),n=!1},d(e){L(a,e)}}}function T(m){let a,n,e,i,l,o,c,t=m[0].length!==0&&$(m);return{c(){a=g("link"),n=g("link"),e=g("script"),i=S("let parcelRequire;"),l=x(),t&&t.c(),o=b(),this.h()},l(r){const s=G('[data-svelte="svelte-uncxtc"]',document.head);a=v(s,"LINK",{rel:!0,href:!0}),n=v(s,"LINK",{rel:!0,href:!0}),e=v(s,"SCRIPT",{});var f=J(e);i=N(f,"let parcelRequire;"),f.forEach(u),s.forEach(u),l=A(r),t&&t.l(r),o=b(),this.h()},h(){_(a,"rel","icon"),_(a,"href",""+(k+"/favicon.png")),_(n,"rel","manifest"),_(n,"href",""+(k+"/manifest.json")),document.title="Join"},m(r,s){d(document.head,a),d(document.head,n),d(document.head,e),d(e,i),y(r,l,s),t&&t.m(r,s),y(r,o,s),c=!0},p(r,[s]){r[0].length!==0?t?(t.p(r,s),s&1&&p(t,1)):(t=$(r),t.c(),p(t,1),t.m(o.parentNode,o)):t&&(K(),h(t,1,1,()=>{t=null}),C())},i(r){c||(p(t),c=!0)},o(r){h(t),c=!1},d(r){u(a),u(n),u(e),r&&u(l),t&&t.d(r),r&&u(o)}}}function U(m,a,n){let e=[];return D(async()=>{const l=(await j(()=>import("../chunks/peerjs.min-90eb8cad.js").then(function(r){return r.p}),["chunks/peerjs.min-90eb8cad.js","chunks/vendor-07f555be.js"])).default;let o=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});n(0,e=[o]);let c=new URL(window.location.href),t=new l(void 0,{config:{iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:numb.viagenie.ca",credential:"muazkh",username:"webrtc@live.com"}]}});t.on("open",()=>{t.call(c.searchParams.get("room"),o).on("stream",s=>{e.map(f=>f.id).includes(s.id)||n(0,e=[...e,s])}),t.connect(c.searchParams.get("room"))})}),[e]}class V extends w{constructor(a){super();P(this,a,U,T,R,{})}}export{V as default};
