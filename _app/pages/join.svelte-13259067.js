import{b as A,_ as J}from"../chunks/paths-16c013c9.js";import{S as K,i as H,s as O,j as V,m as j,o as D,x as b,u as k,v as I,e as L,t as z,k as R,L as B,c as q,a as U,g as F,d as _,n as C,b as E,H as S,f as N,w as Q,A as W,r as X}from"../chunks/vendor-f7df6e26.js";import{N as Y,C as Z,M as x,G as ee,S as se}from"../chunks/Members-555fba25.js";function y(t){let o,r;return o=new ee({props:{streams:t[3],sidePanelVisible:t[1]||t[2]}}),{c(){V(o.$$.fragment)},l(s){j(o.$$.fragment,s)},m(s,c){D(o,s,c),r=!0},p(s,c){const f={};c&8&&(f.streams=s[3]),c&6&&(f.sidePanelVisible=s[1]||s[2]),o.$set(f)},i(s){r||(b(o.$$.fragment,s),r=!0)},o(s){k(o.$$.fragment,s),r=!1},d(s){I(o,s)}}}function re(t){let o,r,s,c,f,a,i,w,p,P,h,M,d,v;i=new Y({props:{time:t[4],peer:!0}}),i.$on("videoswitch",t[6]),i.$on("muteswitch",t[7]),i.$on("sourceswitch",t[8]),i.$on("chatswitch",t[9]),i.$on("membersswitch",t[10]);let n=t[3].length!==0&&y(t);return h=new Z({props:{visible:t[1],messages:t[5]}}),h.$on("close",t[11]),h.$on("messagesend",t[12]),d=new x({props:{visible:t[2],users:t[3]}}),d.$on("close",t[13]),{c(){o=L("link"),r=L("link"),s=L("script"),c=z("let parcelRequire;"),f=R(),a=L("div"),V(i.$$.fragment),w=R(),n&&n.c(),P=R(),V(h.$$.fragment),M=R(),V(d.$$.fragment),this.h()},l(e){const l=B('[data-svelte="svelte-uncxtc"]',document.head);o=q(l,"LINK",{rel:!0,href:!0}),r=q(l,"LINK",{rel:!0,href:!0}),s=q(l,"SCRIPT",{});var m=U(s);c=F(m,"let parcelRequire;"),m.forEach(_),l.forEach(_),f=C(e),a=q(e,"DIV",{class:!0});var u=U(a);j(i.$$.fragment,u),w=C(u),n&&n.l(u),u.forEach(_),P=C(e),j(h.$$.fragment,e),M=C(e),j(d.$$.fragment,e),this.h()},h(){E(o,"rel","icon"),E(o,"href",""+(A+"/favicon.png")),E(r,"rel","manifest"),E(r,"href",""+(A+"/manifest.json")),document.title="Join",E(a,"class",p=""+((t[1]||t[2]?"hidden":"flex")+" md:flex flex-col h-screen w-full items-center"))},m(e,l){S(document.head,o),S(document.head,r),S(document.head,s),S(s,c),N(e,f,l),N(e,a,l),D(i,a,null),S(a,w),n&&n.m(a,null),N(e,P,l),D(h,e,l),N(e,M,l),D(d,e,l),v=!0},p(e,[l]){const m={};l&16&&(m.time=e[4]),i.$set(m),e[3].length!==0?n?(n.p(e,l),l&8&&b(n,1)):(n=y(e),n.c(),b(n,1),n.m(a,null)):n&&(X(),k(n,1,1,()=>{n=null}),Q()),(!v||l&6&&p!==(p=""+((e[1]||e[2]?"hidden":"flex")+" md:flex flex-col h-screen w-full items-center")))&&E(a,"class",p);const u={};l&2&&(u.visible=e[1]),l&32&&(u.messages=e[5]),h.$set(u);const $={};l&4&&($.visible=e[2]),l&8&&($.users=e[3]),d.$set($)},i(e){v||(b(i.$$.fragment,e),b(n),b(h.$$.fragment,e),b(d.$$.fragment,e),v=!0)},o(e){k(i.$$.fragment,e),k(n),k(h.$$.fragment,e),k(d.$$.fragment,e),v=!1},d(e){_(o),_(r),_(s),e&&_(f),e&&_(a),I(i),n&&n.d(),e&&_(P),I(h,e),e&&_(M),I(d,e)}}}function te(t,o,r){let s,c=!1,f=!1,a=[],i=0,w=[],p="";return W(async()=>{const u=(await J(()=>import("../chunks/Peer-10c1c35a.js"),["chunks/Peer-10c1c35a.js","chunks/index-d400411c.js","chunks/vendor-f7df6e26.js","assets/vendor-b8c56e4e.css"])).default;p=window.prompt("Enter username: ");let $=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),G=new URL(window.location.href);r(0,s=new u(p,$,G.searchParams.get("room"))),s.on("peer",g=>{a.map(T=>T.stream.id).includes(g.stream.id)||r(3,a=[...a,g])}),s.on("open",g=>{r(3,a=[{id:g,username:p,stream:$}]),setInterval(()=>r(4,i++,i),1e3)}),s.on("disconnect",g=>{r(3,a=a.filter(T=>T.id!=g))}),s.on("message",g=>{r(5,w=[...w,g])})}),[s,c,f,a,i,w,()=>{a[0].stream.getVideoTracks().forEach(m=>m.enabled=!m.enabled),r(3,a)},()=>{a[0].stream.getAudioTracks().forEach(m=>m.enabled=!m.enabled),r(3,a)},async m=>{let u=m.detail.source==se.Screen?await navigator.mediaDevices.getDisplayMedia({video:!0}):await navigator.mediaDevices.getUserMedia({video:!0});s.replaceStream(u)},()=>{r(1,c=!c),r(2,f=!1)},()=>{r(2,f=!f),r(1,c=!1)},()=>r(1,c=!1),m=>s.send(m.detail.message),()=>r(2,f=!1)]}class oe extends K{constructor(o){super();H(this,o,te,re,O,{})}}export{oe as default};
